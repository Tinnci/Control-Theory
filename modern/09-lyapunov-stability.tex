\section{稳定性与李雅普诺夫方法}

\subsection{李雅普诺夫稳定性定义}
考虑自治系统 $\dot{x} = f(x)$，设 $x_e$ 为平衡点：
\begin{itemize}
    \item \textbf{稳定}：对任意 $\varepsilon > 0$，存在 $\delta > 0$，当 $\|x(0) - x_e\| < \delta$ 时，有 $\|x(t) - x_e\| < \varepsilon$，$\forall t \geq 0$
    \item \textbf{渐近稳定}：稳定且 $\lim_{t \to \infty} x(t) = x_e$
    \item \textbf{大范围渐近稳定}：渐近稳定且吸引域为整个状态空间
\end{itemize}

\subsection{李雅普诺夫第一方法（线性化方法）}

\subsubsection{基本原理}

对于非线性系统 $\dot{\mathbf{x}} = \mathbf{f}(\mathbf{x})$，在平衡点 $\mathbf{x}_e$ 附近，可以用线性系统近似：
\[\dot{\mathbf{z}} = A\mathbf{z}\]

其中 $A$ 是\textbf{雅可比矩阵}（Jacobian Matrix）：
\[A = \left.\frac{\partial \mathbf{f}}{\partial \mathbf{x}}\right|_{\mathbf{x}=\mathbf{x}_e}\]

\textbf{稳定性判据：}

\begin{itemize}
    \item 如果 $A$ 的所有特征值实部\textbf{都严格小于零}，则平衡点\textbf{局部渐近稳定}
    \item 如果 $A$ 至少有一个特征值实部\textbf{大于零}，则平衡点\textbf{不稳定}
    \item 如果 $A$ 有特征值实部\textbf{等于零}（且无实部大于零的特征值），则方法\textbf{失效}，无法判断
\end{itemize}

对于线性系统 $\dot{x} = Ax$，系统渐近稳定的充要条件是矩阵 $A$ 的所有特征值都具有负实部。

\subsection{李雅普诺夫第二方法（直接方法）}
\textbf{李雅普诺夫定理}：如果存在标量函数 $V(x)$ 满足：
\begin{enumerate}
    \item $V(x)$ 连续且有连续的一阶偏导数
    \item $V(x_e) = 0$，当 $x \neq x_e$ 时 $V(x) > 0$（正定）
    \item $\dot{V}(x) = \frac{\partial V}{\partial x} f(x) \leq 0$（半负定）
\end{enumerate}
则平衡点 $x_e$ 稳定。

若进一步有 $\dot{V}(x) < 0$（负定），则平衡点渐近稳定。

\subsection{线性系统的李雅普诺夫方程}
对于线性系统 $\dot{x} = Ax$，选择二次型李雅普诺夫函数：
\[V(x) = x^T P x\]

其中 $P$ 为正定矩阵。稳定的充要条件是李雅普诺夫方程：
\[A^T P + PA = -Q\]
对于给定的正定矩阵 $Q$，存在唯一的正定解 $P$。

\subsection{李雅普诺夫方法的核心思想}

\subsubsection{直观理解}
李雅普诺夫方法的思想非常直观：\textbf{如果能为系统找到一个类似于「能量」的函数 $V(x)$，并且证明这个「能量」总是随时间减少（或至少不增加），那么系统最终必然会稳定下来。}

\begin{itemize}
    \item 这个函数 $V(x)$ 称为\textbf{李雅普诺夫函数}
    \item $V(x)$ 必须是\textbf{正定的}（类似能量总是正的）
    \item $V(x)$ 的导数 $\dot{V}(x)$ 必须是\textbf{负定的或半负定的}（能量随时间衰减或保持不变）
\end{itemize}

\subsubsection{线性系统的二次型李雅普诺夫函数}

对于线性系统 $\dot{x} = Ax$，我们选择二次型的李雅普诺夫函数 $V(x) = x^T P x$，其中 $P$ 是对称正定矩阵。

对 $V(x)$ 求导：
\begin{align*}
\dot{V}(x) &= \frac{d}{dt}(x^T P x) \\
&= \dot{x}^T P x + x^T P \dot{x} \\
&= (Ax)^T P x + x^T P (Ax) \\
&= x^T A^T P x + x^T P A x \\
&= x^T(A^T P + PA)x
\end{align*}

为了让 $\dot{V}(x)$ 是负定的，通常令 $\dot{V}(x) = -x^T Q x$，其中 $Q$ 是我们选择的对称正定矩阵。因此得到：
\[\boxed{A^T P + PA = -Q}\]

这就是著名的\textbf{李雅普诺夫方程}。

\subsubsection{判据总结}

对于给定的系统矩阵 $A$：
\begin{itemize}
    \item 如果对\textbf{任意}正定矩阵 $Q$，李雅普诺夫方程都有唯一的\textbf{正定解} $P$，则系统\textbf{渐近稳定}
    \item 如果对某个正定矩阵 $Q$，方程无解或解不是正定的，则系统\textbf{不是渐近稳定的}
    \item 如果能找到半正定的 $Q$ 使得存在正定的 $P$，但对所有正定 $Q$ 都无解，则系统可能是\textbf{李雅普诺夫稳定}（临界稳定）
\end{itemize}

\subsection{局部稳定性 vs 全局稳定性}

\subsubsection{核心概念辨析}

在李雅普诺夫理论中，\textbf{局部渐近稳定}和\textbf{全局渐近稳定}（又称\textbf{大范围渐近稳定}）是两个截然不同的概念。区分它们对于理解非线性系统的稳定性至关重要。

\paragraph{1. 局部渐近稳定 (Local Asymptotic Stability)}

\textbf{直观比喻：}想象一个\textbf{放在巨大桌子中央的小碗}。

\textbf{含义：}
\begin{itemize}
    \item 只要初始状态在平衡点的\textbf{某个邻域}内（碗里面），系统最终会收敛到平衡点
    \item 但如果初始状态在这个邻域之外（碗外面的桌子上），系统行为无法保证
    \item 这个邻域称为\textbf{吸引域 (Domain of Attraction)} 或\textbf{稳定域}
\end{itemize}

\textbf{数学定义：}存在 $\delta > 0$，当 $\|x(0) - x_e\| < \delta$ 时，有 $\lim_{t \to \infty} x(t) = x_e$。

\paragraph{2. 全局渐近稳定 (Global Asymptotic Stability)}

\textbf{直观比喻：}想象\textbf{整个地球就是一个巨大的碗}，只有一个最低点。

\textbf{含义：}
\begin{itemize}
    \item \textbf{无论初始状态在状态空间的任何位置}，系统最终都会收敛到平衡点
    \item 吸引域是\textbf{整个状态空间}
    \item 这是一个非常强的性质，在实际系统中并不常见
\end{itemize}

\textbf{数学定义：}对于\textbf{任意}初始状态 $x(0)$，都有 $\lim_{t \to \infty} x(t) = x_e$。

\subsubsection{全局稳定性的判断条件}

要证明全局渐近稳定，李雅普诺夫函数必须满足更严格的条件：

\begin{enumerate}
    \item $V(x)$ 在\textbf{整个状态空间}都是正定的
    \item $\dot{V}(x)$ 在\textbf{整个状态空间}都是负定的（除平衡点外）
    \item \textbf{$V(x)$ 是径向无界的 (Radially Unbounded)}：
    \[\lim_{\|x\| \to \infty} V(x) = \infty\]
\end{enumerate}

\paragraph{为什么需要「径向无界」条件？}

\textbf{比喻：}这个条件确保「碗壁是无限高的」。

\textbf{原因：}
\begin{itemize}
    \item 如果 $V(x)$ 在远处趋向某个有限值，可能存在「平坦的高原」
    \item 系统状态可能停留在这个高原上，永远无法回到平衡点
    \item 无限高的碗壁保证了状态总是处于向平衡点倾斜的「斜坡」上
\end{itemize}

对于常用的二次型函数 $V(x) = x^T P x$（$P$ 正定），它天然满足径向无界条件。因此，关键是判断 $\dot{V}(x)$ 是否在\textbf{整个空间}都是负定的。

\subsubsection{判断示例：为什么局部≠全局}

考虑系统：
\begin{align*}
\dot{x}_1 &= -2x_1 + 2x_2^4 \\
\dot{x}_2 &= -x_2
\end{align*}

选择李雅普诺夫函数 $V(x) = \frac{1}{2}x_1^2 + x_2^2$，计算得：
\[\dot{V}(x) = -2x_1^2 + 2x_1x_2^4 - 2x_2^2\]

\paragraph{局部分析（原点附近）}

当 $x_1, x_2$ 很小时，二次项 $-2x_1^2 - 2x_2^2$ 占主导，高阶项 $2x_1x_2^4$ 可忽略，因此 $\dot{V}(x) < 0$。

\textbf{结论：}系统在原点附近是\textbf{局部渐近稳定}的。

\paragraph{全局分析（远离原点）}

取 $x_2 = 2$，$x_1 = 10$：
\[\dot{V}(10, 2) = -2(100) + 2(10)(16) - 2(4) = -200 + 320 - 8 = 112 > 0\]

在点 $(10, 2)$ 处，$\dot{V}(x) > 0$，能量\textbf{正在增加}！

\textbf{结论：}$\dot{V}(x)$ 不是全局负定的，系统\textbf{不是全局渐近稳定}的。

\subsubsection{关键要点总结}

\begin{center}
\renewcommand{\arraystretch}{1.6}
\begin{tabular}{|l|p{6cm}|p{6cm}|}
\hline
\rowcolor[gray]{0.9}
\textbf{对比维度} & \textbf{局部渐近稳定} & \textbf{全局渐近稳定} \\
\hline
\textbf{吸引域} & 平衡点的某个邻域 & 整个状态空间 \\
\hline
\textbf{初始条件要求} & 必须在稳定域内 & 任意初始状态 \\
\hline
\textbf{$V(x)$ 正定性} & 在邻域内正定 & 在整个空间正定 \\
\hline
\textbf{$\dot{V}(x)$ 负定性} & 在邻域内负定 & 在整个空间负定 \\
\hline
\textbf{径向无界条件} & 不要求 & \textbf{必须满足} \\
\hline
\textbf{证明难度} & 相对容易 & 通常很困难 \\
\hline
\textbf{实际意义} & 小扰动下稳定 & 任何扰动下都稳定 \\
\hline
\end{tabular}
\end{center}

\textbf{重要提醒：}
\begin{itemize}
    \item 对于\textbf{线性系统}，局部渐近稳定等价于全局渐近稳定
    \item 对于\textbf{非线性系统}，局部稳定\textbf{不能}推出全局稳定
    \item 在解题时，如果只证明了 $\dot{V}(x)$ 在邻域内负定，结论应是「局部渐近稳定」
    \item 声称「全局稳定」需要更严格的证明
\end{itemize}

\section{李雅普诺夫稳定性判断——范例}

\subsection{范例：临界稳定系统的李雅普诺夫分析}

\subsubsection{题目}

判断系统稳定性：
\begin{align*}
\dot{x} &= \begin{bmatrix} 0 & 1 \\ -1 & 0 \end{bmatrix} x + \begin{bmatrix} 1 \\ 0 \end{bmatrix} u \\
y &= \begin{bmatrix} 0 & 1 \end{bmatrix} x
\end{align*}

其中 $A = \begin{bmatrix} 0 & 1 \\ -1 & 0 \end{bmatrix}$

\subsubsection{解答}

判断稳定性时，我们只关心\textbf{零输入响应}（令 $u=0$），因此只分析系统矩阵 $A$。

\paragraph{方法一：特征值法（快速验证）}

这是最直接的方法，用于判断系统的稳定性。

计算特征值，解 $\det(\lambda I - A) = 0$：
\[\det \begin{bmatrix} \lambda & -1 \\ 1 & \lambda \end{bmatrix} = \lambda^2 + 1 = 0\]

解得特征值为 $\lambda = \pm i$。

\textbf{结论：}特征值的实部为 0，因此系统是\textbf{李雅普诺夫稳定}的（也称\textbf{临界稳定}），但\textbf{不是渐进稳定}。系统受扰动后会产生等幅振荡。

\paragraph{方法二：李雅普诺夫第二方法（题目要求）}

\begin{enumerate}
    \item \textbf{选择对称正定矩阵 $Q$：}
    
    最简单的选择是单位矩阵：
    \[Q = \begin{bmatrix} 1 & 0 \\ 0 & 1 \end{bmatrix}\]
    
    \item \textbf{设定待求的对称矩阵 $P$：}
    
    令 $P = \begin{bmatrix} p_{11} & p_{12} \\ p_{12} & p_{22} \end{bmatrix}$
    
    \item \textbf{构建李雅普诺夫方程 $A^T P + PA = -Q$：}
    
    首先计算各项：
    \[A^T = \begin{bmatrix} 0 & -1 \\ 1 & 0 \end{bmatrix}\]
    
    \[A^T P = \begin{bmatrix} 0 & -1 \\ 1 & 0 \end{bmatrix} \begin{bmatrix} p_{11} & p_{12} \\ p_{12} & p_{22} \end{bmatrix} = \begin{bmatrix} -p_{12} & -p_{22} \\ p_{11} & p_{12} \end{bmatrix}\]
    
    \[PA = \begin{bmatrix} p_{11} & p_{12} \\ p_{12} & p_{22} \end{bmatrix} \begin{bmatrix} 0 & 1 \\ -1 & 0 \end{bmatrix} = \begin{bmatrix} -p_{12} & p_{11} \\ -p_{22} & p_{12} \end{bmatrix}\]
    
    \[A^T P + PA = \begin{bmatrix} -2p_{12} & p_{11}-p_{22} \\ p_{11}-p_{22} & 2p_{12} \end{bmatrix}\]
    
    令其等于 $-Q = \begin{bmatrix} -1 & 0 \\ 0 & -1 \end{bmatrix}$：
    \[\begin{bmatrix} -2p_{12} & p_{11}-p_{22} \\ p_{11}-p_{22} & 2p_{12} \end{bmatrix} = \begin{bmatrix} -1 & 0 \\ 0 & -1 \end{bmatrix}\]
    
    \item \textbf{分析方程组：}
    
    由上式可得：
    \begin{align*}
    -2p_{12} &= -1 \implies p_{12} = \frac{1}{2} & \text{(第(1,1)元素)} \\
    p_{11} - p_{22} &= 0 \implies p_{11} = p_{22} & \text{(第(1,2)元素)} \\
    2p_{12} &= -1 \implies p_{12} = -\frac{1}{2} & \text{(第(2,2)元素)}
    \end{align*}
    
    \textbf{出现矛盾！}从第(1,1)元素得 $p_{12} = \frac{1}{2}$，而从第(2,2)元素得 $p_{12} = -\frac{1}{2}$。
    
    这意味着对于正定矩阵 $Q=I$，\textbf{李雅普诺夫方程无解}。
    
    \item \textbf{得出结论：}
    
    根据李雅普诺夫稳定性判据，如果系统是渐进稳定的，那么对于\textbf{任意}正定 $Q$，都\textbf{必须}能解出唯一的正定 $P$。
    
    现在我们发现，对于最简单的正定 $Q=I$，方程都无解，这直接说明了系统\textbf{不是渐进稳定的}。
\end{enumerate}

\subsubsection{结论汇总}

\begin{center}
\begin{tabular}{|l|l|}
\hline
\textbf{判断方法} & \textbf{结论} \\
\hline
特征值法 & 特征值 $\lambda = \pm i$，实部为 0，系统李雅普诺夫稳定但不渐近稳定 \\
\hline
李雅普诺夫第二方法 & 对正定 $Q=I$，方程无正定解 $P$，系统不渐近稳定 \\
\hline
\textbf{最终结论} & \textbf{系统临界稳定（李雅普诺夫稳定），受扰动后产生等幅振荡} \\
\hline
\end{tabular}
\end{center}

\subsection{范例 2：非线性系统的线性化分析}

\subsubsection{题目}

使用李雅普诺夫第一方法（线性化方法）分析系统的稳定性：
\begin{align*}
\dot{x}_1 &= -6x_1 - x_2 \\
\dot{x}_2 &= -2x_1 - 6x_2 - 2x_2^3
\end{align*}

\subsubsection{解答思路}

对于非线性系统，直接寻找合适的李雅普诺夫函数（第二方法）往往非常困难。\textbf{李雅普诺夫第一方法}（也称\textbf{间接法}）提供了一条捷径：在平衡点附近对系统进行\textbf{线性化}，然后分析线性化系统的稳定性。

\paragraph{第一步：寻找平衡点}

令 $\dot{x}_1 = 0$ 和 $\dot{x}_2 = 0$：
\begin{align*}
-6x_1 - x_2 &= 0 \implies x_2 = -6x_1 \quad (1) \\
-2x_1 - 6x_2 - 2x_2^3 &= 0 \quad (2)
\end{align*}

将 (1) 式代入 (2) 式：
\begin{align*}
-2x_1 - 6(-6x_1) - 2(-6x_1)^3 &= 0 \\
-2x_1 + 36x_1 - 2(-216x_1^3) &= 0 \\
34x_1 + 432x_1^3 &= 0 \\
x_1(34 + 432x_1^2) &= 0
\end{align*}

由于 $34 + 432x_1^2 > 0$ 对所有实数 $x_1$ 成立，因此 $x_1 = 0$，进而 $x_2 = 0$。

\textbf{结论：}系统有唯一平衡点 $(0, 0)$。

\paragraph{第二步：在平衡点处线性化系统}

对于非线性系统 $\dot{\mathbf{x}} = \mathbf{f}(\mathbf{x})$，在平衡点 $\mathbf{x}_e$ 附近的线性化系统为：
\[\dot{\mathbf{z}} = A \mathbf{z}\]

其中 $A$ 是\textbf{雅可比矩阵 (Jacobian Matrix)}：
\[A = J(\mathbf{x}_e) = \left.\begin{bmatrix} 
\frac{\partial f_1}{\partial x_1} & \frac{\partial f_1}{\partial x_2} \\
\frac{\partial f_2}{\partial x_1} & \frac{\partial f_2}{\partial x_2}
\end{bmatrix}\right|_{\mathbf{x} = \mathbf{x}_e}\]

\textbf{1. 定义非线性函数}
\[\mathbf{f}(\mathbf{x}) = \begin{bmatrix} f_1(x_1, x_2) \\ f_2(x_1, x_2) \end{bmatrix} = \begin{bmatrix} -6x_1 - x_2 \\ -2x_1 - 6x_2 - 2x_2^3 \end{bmatrix}\]

\textbf{2. 计算偏导数}
\begin{align*}
\frac{\partial f_1}{\partial x_1} &= -6, \quad \frac{\partial f_1}{\partial x_2} = -1 \\
\frac{\partial f_2}{\partial x_1} &= -2, \quad \frac{\partial f_2}{\partial x_2} = -6 - 6x_2^2
\end{align*}

\textbf{3. 构造雅可比矩阵}
\[J(\mathbf{x}) = \begin{bmatrix} -6 & -1 \\ -2 & -6 - 6x_2^2 \end{bmatrix}\]

\textbf{4. 在平衡点 $(0, 0)$ 处计算}
\[A = J(0, 0) = \begin{bmatrix} -6 & -1 \\ -2 & -6 \end{bmatrix}\]

\paragraph{第三步：分析线性化系统的特征值}

求解特征方程 $\det(\lambda I - A) = 0$：
\begin{align*}
\det \begin{bmatrix} \lambda + 6 & 1 \\ 2 & \lambda + 6 \end{bmatrix} &= 0 \\
(\lambda + 6)^2 - 2 &= 0 \\
\lambda^2 + 12\lambda + 36 - 2 &= 0 \\
\lambda^2 + 12\lambda + 34 &= 0
\end{align*}

使用求根公式：
\begin{align*}
\lambda &= \frac{-12 \pm \sqrt{144 - 136}}{2} = \frac{-12 \pm \sqrt{8}}{2} \\
&= \frac{-12 \pm 2\sqrt{2}}{2} = -6 \pm \sqrt{2}
\end{align*}

两个特征值为：
\begin{align*}
\lambda_1 &= -6 + \sqrt{2} \approx -4.586 \\
\lambda_2 &= -6 - \sqrt{2} \approx -7.414
\end{align*}

\paragraph{第四步：根据李雅普诺夫第一方法下结论}

\textbf{李雅普诺夫第一方法判据：}

\begin{itemize}
    \item 如果线性化系统的所有特征值\textbf{实部都严格小于零}，则原非线性系统在该平衡点\textbf{局部渐近稳定}
    \item 如果至少有一个特征值实部大于零，则原系统\textbf{不稳定}
    \item 如果存在实部为零的特征值，则该方法\textbf{失效}，无法判断
\end{itemize}

\textbf{分析：}两个特征值都是负实数，实部均严格小于零。

\textbf{最终结论：}根据李雅普诺夫第一方法，原非线性系统在平衡点 $(0, 0)$ 处是\textbf{局部渐近稳定}的。

\subsubsection{方法对比与选择}

\begin{center}
\renewcommand{\arraystretch}{1.6}
\begin{tabular}{|l|p{6cm}|p{6cm}|}
\hline
\rowcolor[gray]{0.9}
\textbf{方法} & \textbf{李雅普诺夫第一方法} & \textbf{李雅普诺夫第二方法} \\
\hline
\textbf{别名} & 间接法、线性化方法 & 直接法 \\
\hline
\textbf{核心思想} & 在平衡点附近线性化，分析线性系统特征值 & 构造能量函数 $V(x)$，验证其沿轨迹递减 \\
\hline
\textbf{优点} & 
计算简单、步骤明确 \newline 
只需计算雅可比矩阵和特征值 & 
适用于所有非线性系统 \newline 
可能得到全局稳定性结论 \\
\hline
\textbf{缺点} & 
只能判断局部稳定性 \newline 
特征值实部为零时失效 & 
构造李雅普诺夫函数困难 \newline 
没有通用方法 \\
\hline
\textbf{适用场景} & 
平衡点附近稳定性分析 \newline 
作为初步快速判断 & 
需要全局稳定性分析 \newline 
线性化方法失效时 \\
\hline
\end{tabular}
\end{center}

\textbf{解题建议：}
\begin{itemize}
    \item 对于非线性系统，\textbf{优先尝试第一方法}（线性化），因为计算简单
    \item 如果线性化后特征值实部为零，或需要全局稳定性结论，再考虑第二方法
    \item 第二方法需要灵活性和经验，往往需要多次尝试不同的候选函数
\end{itemize}
