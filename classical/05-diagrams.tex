\section{结构图与信号流图}

\subsection{结构图的基本元件}
\begin{itemize}
    \item \textbf{方块}：表示系统或环节的传递函数
    \item \textbf{信号线}：表示信号的传输方向
    \item \textbf{相加点}：表示信号的相加或相减
    \item \textbf{分支点}：表示信号的分叉
\end{itemize}

\tikzstyle{block} = [draw, rectangle, minimum height=3em, minimum width=4em]
\tikzstyle{sum} = [draw, circle, node distance=1.5cm]
\tikzstyle{input} = [coordinate]
\tikzstyle{output} = [coordinate]
\tikzstyle{node} = [circle,draw,inner sep=2pt]

\begin{figure}[h!]
\centering
\begin{tikzpicture}[auto, node distance=2.5cm, >=Latex]
    \node [input, name=input] {};
    \node [block, right=of input] (controller) {控制器};
    \node [block, right=of controller] (plant) {被控对象};
    \node [output, right=of plant] (output) {};
    \draw [->] (input) -- node[name=r] {$R(s)$} (controller);
    \draw [->] (controller) -- node {$U(s)$} (plant);
    \draw [->] (plant) -- node[name=y] {$Y(s)$} (output);
\end{tikzpicture}
\caption{开环控制系统示例}
\end{figure}

\begin{figure}[h!]
\centering
\begin{tikzpicture}[auto, node distance=2cm, >=Latex]
    \node [input, name=input] {};
    \node [sum, right=of input] (sum) {};
    \node [block, right=of sum] (controller) {控制器};
    \node [block, right=of controller, node distance=3cm] (plant) {被控对象};
    \coordinate [right=of plant, node distance=3cm] (output) {};
    \node [block, below=of plant] (sensor) {传感器};
    
    \draw [->] (input) -- node[pos=0.9] {$R(s)$} node[pos=0.9, above] {$+$} (sum);
    \draw [->] (sum) -- node {$E(s)$} (controller);
    \draw [->] (controller) -- (plant);
    \draw [->] (plant) -- node [name=y, near end] {$Y(s)$} (output);
    \draw [->] (y) |- (sensor);
    \draw [->] (sensor) -| node[pos=0.9, right] {$-$} (sum);
\end{tikzpicture}
\caption{闭环（反馈）控制系统示例}
\end{figure}

\subsection{结构图的等效变换}
\begin{itemize}
    \item 串联：$G(s) = G_1(s)G_2(s)$
    \item 并联：$G(s) = G_1(s) + G_2(s)$
    \item 反馈：$G(s) = \frac{G_1(s)}{1 \pm G_1(s)H(s)}$
\end{itemize}

\subsection{信号流图}
信号流图是用有向线段和节点组成的图形，用来表示系统各变量之间的关系。

\begin{figure}[h!]
\centering
\begin{tikzpicture}[auto, node distance=2.5cm, >=Latex]
    \node[input] (start) {};
    \node[node, right=of start] (r) {$R(s)$};
    \node[node, right=of r] (e) {};
    \node[node, right=of e] (u) {};
    \node[node, right=of u] (y) {$Y(s)$};
    \node[output, right=of y] (end) {};

    \draw[->] (start) -- node[above, very near start] {输入} (r);
    \draw[->] (r) -- node[above,midway] {1} (e);
    \draw[->] (e) -- node[above,midway] {$G_c(s)$} (u);
    \draw[->] (u) -- node[above,midway] {$G_p(s)$} (y);
    \draw[->] (y) -- node[above, very near end] {输出} (end);
    \draw[->] (y) to[bend right=60] node[below,midway] {$-H(s)$} (e);
\end{tikzpicture}
\caption{包含控制器和传感器的信号流图示例}
\end{figure}

\subsection{具体示例}

\begin{tcolorbox}[colback=blue!5!white,colframe=blue!75!black,title=具体示例]
\textbf{结构图示例}

\begin{minipage}[t]{0.47\textwidth}
系统开环传递函数为：
$$ G(s) = \frac{5}{s^2 + 2s + 4} $$
反馈为单位负反馈 $H(s)=1$。
\end{minipage}\hfill
\begin{minipage}[t]{0.47\textwidth}
\centering
\adjustbox{max width=\linewidth}{
\begin{tikzpicture}[auto, node distance=3cm, >=Latex]
    \node [input, name=input] {};
    \node [sum, right=of input] (sum) {};
    \node [block, right=of sum, node distance=2.8cm] (controller) {$5$};
    \node [block, right=of controller, node distance=3.5cm] (plant) {$\frac{1}{s^2 + 2s + 4}$};
    \coordinate [right=of plant, node distance=3.5cm] (output) {};
    
    \draw [->] (input) -- node[pos=0.5, above=0.1cm] {$R(s)$} (sum);
    \draw [->] (sum) -- (controller);
    \draw [->] (controller) -- (plant);
    \draw [->] (plant) -- node [name=y, near end] {$Y(s)$} (output);
    \draw [->] (y) |- ++(0,-1.5cm) -| node[pos=0.8, right=0.1cm] {$-$} (sum);
\end{tikzpicture}
}
\end{minipage}

\tcblower

\textbf{信号流图示例}

\begin{minipage}[t]{0.47\textwidth}
与上方系统等效的信号流图。前向通路增益为 $G(s)$，反馈回路增益为 $-H(s)$。
$$ G(s) = \frac{5}{s^2 + 2s + 4} \quad H(s)=1 $$
\end{minipage}\hfill
\begin{minipage}[t]{0.47\textwidth}
\centering
\adjustbox{max width=\linewidth}{
\begin{tikzpicture}[auto, node distance=3cm, >=Latex]
    \node[node] (r) {$R(s)$};
    \node[node, right=of r] (e) {};
    \node[node, right=of e] (y) {$Y(s)$};
    \node[output, right=of y] (end) {};

    \draw[->] (r) -- node[above,midway] {1} (e);
    \draw[->] (e) -- node[below=0.1cm,midway] {$\frac{5}{s^2 + 2s + 4}$} (y);
    \draw[->] (y) -- (end);
    \draw[->] (y) to[bend right=45] node[above=0.2cm,midway] {$-1$} (e);
\end{tikzpicture}
}
\end{minipage}
\end{tcolorbox}
