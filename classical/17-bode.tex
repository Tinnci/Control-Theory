\section{伯德图绘制}

\subsection{伯德图的定义}
伯德图（Bode Plot）是由亨德里克·韦德·伯德（Hendrik Wade Bode）提出的频率响应图示方法，由两个图组成：

\begin{itemize}
    \item \textbf{幅频特性图（Magnitude Plot）}：$L(\omega) = 20\lg|G(\jw)|$ dB vs $\lg\omega$
    \begin{itemize}
        \item 纵轴：对数幅值（dB）
        \item 横轴：对数频率（$\lg\omega$）
    \end{itemize}
    \item \textbf{相频特性图（Phase Plot）}：$\phi(\omega) = \angle G(\jw)$ vs $\lg\omega$
    \begin{itemize}
        \item 纵轴：相位角（度或弧度）
        \item 横轴：对数频率（$\lg\omega$）
    \end{itemize}
\end{itemize}

\textbf{伯德图的优点：}
\begin{enumerate}
    \item 频率范围广，可表示从极低频到极高频的特性
    \item 不同环节的伯德图可以直接相加（叠加原理）
    \item 可用渐近线逼近，绘制简便
    \item 便于分析系统的稳定性和性能指标
\end{enumerate}

\subsection{典型环节的伯德图}

\subsubsection{比例环节 \texorpdfstring{$K$}{K}}
传递函数：$G(s) = K$

频率响应：$G(\jw) = K$

\textbf{幅频特性：}
\begin{align*}
L(\omega) &= 20\lg K \text{ dB（水平线）}
\end{align*}

\textbf{相频特性：}
\begin{align*}
\phi(\omega) &= \begin{cases}
0° & K > 0 \\
180° & K < 0
\end{cases}
\end{align*}

\subsubsection{积分环节 $\frac{1}{s}$}
传递函数：$G(s) = \frac{1}{s}$

频率响应：$G(\jw) = \frac{1}{\jw}$

\textbf{幅频特性：}
\begin{align*}
L(\omega) &= 20\lg\frac{1}{\omega} = -20\lg\omega \text{ dB}
\end{align*}
\begin{itemize}
    \item 斜率：$-20$ dB/十倍频（decade）
    \item 当 $\omega = 1$ rad/s 时，$L(\omega) = 0$ dB
    \item 当 $\omega$ 增大10倍时，$L(\omega)$ 下降20 dB
\end{itemize}

\textbf{相频特性：}
\begin{align*}
\phi(\omega) &= -90°\text{（恒定）}
\end{align*}

\subsubsection{微分环节 $s$}
与积分环节对称：
\begin{itemize}
    \item $L(\omega) = 20\lg\omega$ dB（斜率 $+20$ dB/十倍频）
    \item $\phi(\omega) = 90°$
\end{itemize}

\subsubsection{惯性环节 \texorpdfstring{$\frac{1}{1+Ts}$}{1/(1+Ts)}}
传递函数：$G(s) = \frac{1}{1+Ts}$

频率响应：$G(\jw) = \frac{1}{1+\jw T}$

\textbf{转折频率（Corner Frequency）：}$\omega_c = \frac{1}{T}$ rad/s

\textbf{幅频特性：}
\begin{align*}
L(\omega) &= 20\lg|G(\jw)| = -20\lg\sqrt{1 + \omega^2T^2}
\end{align*}

渐近线：
\begin{itemize}
    \item 当 $\omega \ll \omega_c$：$L(\omega) \approx 0$ dB
    \item 当 $\omega \gg \omega_c$：$L(\omega) \approx -20\lg(\omega T)$ dB（斜率 $-20$ dB/十倍频）
    \item 转折点 $\omega = \omega_c$：精确值 $L(\omega_c) = -3$ dB
\end{itemize}

\textbf{相频特性：}
\begin{align*}
\phi(\omega) &= -\arctan(\omega T)
\end{align*}
\begin{itemize}
    \item $\omega = 0.1\omega_c$：$\phi \approx -6°$
    \item $\omega = \omega_c$：$\phi = -45°$
    \item $\omega = 10\omega_c$：$\phi \approx -84°$
    \item $\omega \to \infty$：$\phi \to -90°$
\end{itemize}

\textbf{示例伯德图：}$G(s) = \frac{1}{1+0.1s}$ ($\omega_c = 10$ rad/s)
\begin{center}
% Bode plot for G(s) = 1/(1+0.1 s), corner freq ω_c = 10 rad/s
\BodeTF{num/{1},den/{0.1,1}}{0.1}{1000}
\end{center}

\subsubsection{一阶微分环节 $1+Ts$}
与惯性环节对称：
\begin{itemize}
    \item 幅频特性：低频0 dB，高频斜率 $+20$ dB/十倍频
    \item 相频特性：$\phi(\omega) = \arctan(\omega T)$，$\phi(\omega_c) = 45°$
\end{itemize}

\subsubsection{振荡环节 $\frac{\omega_n^2}{s^2 + 2\zeta\omega_n s + \omega_n^2}$}
传递函数标准形式：
\begin{align*}
G(s) = \frac{\omega_n^2}{s^2 + 2\zeta\omega_n s + \omega_n^2}
\end{align*}

其中：
\begin{itemize}
    \item $\omega_n$：无阻尼自然频率
    \item $\zeta$：阻尼比（$0 < \zeta < 1$）
\end{itemize}

频率响应：
\begin{align*}
G(\jw) = \frac{\omega_n^2}{\omega_n^2 - \omega^2 + 2\jw\zeta\omega_n}
\end{align*}

\textbf{幅频特性：}
\begin{align*}
L(\omega) &= 20\lg\frac{\omega_n^2}{\sqrt{(\omega_n^2-\omega^2)^2 + (2\zeta\omega_n\omega)^2}}
\end{align*}

渐近线：
\begin{itemize}
    \item 当 $\omega \ll \omega_n$：$L(\omega) \approx 0$ dB
    \item 当 $\omega \gg \omega_n$：$L(\omega) \approx -40\lg(\omega/\omega_n)$ dB（斜率 $-40$ dB/十倍频）
    \item 转折频率：$\omega_c = \omega_n$
\end{itemize}

\textbf{谐振峰值（仅当 $\zeta < 0.707$ 时）：}
\begin{itemize}
    \item 谐振频率：$\omega_r = \omega_n\sqrt{1-2\zeta^2}$
    \item 谐振峰值：$M_r = \frac{1}{2\zeta\sqrt{1-\zeta^2}}$
    \item 当 $\zeta$ 很小时，谐振峰值很大
\end{itemize}

\textbf{转折频率处的精确值：}
\begin{itemize}
    \item $L(\omega_n) = -20\lg(2\zeta)$ dB
    \item 当 $\zeta = 0.707$ 时，$L(\omega_n) = -3$ dB（无谐振）
    \item 当 $\zeta < 0.707$ 时，$L(\omega_n) > -3$ dB（有谐振）
    \item 当 $\zeta > 0.707$ 时，$L(\omega_n) < -3$ dB（过阻尼）
\end{itemize}

\textbf{相频特性：}
\begin{align*}
\phi(\omega) &= -\arctan\frac{2\zeta\omega_n\omega}{\omega_n^2-\omega^2}
\end{align*}
\begin{itemize}
    \item $\omega = \omega_n$：$\phi = -90°$（与 $\zeta$ 无关）
    \item $\omega \to 0$：$\phi \to 0°$
    \item $\omega \to \infty$：$\phi \to -180°$
    \item $\zeta$ 越小，相位变化越快
\end{itemize}

\textbf{不同阻尼比的伯德图对比：}

\begin{center}
\begin{tikzpicture}
\begin{groupplot}[
    group style={group size=1 by 2, vertical sep=0.5cm},
    width=12cm, height=4cm,
    xmode=log,
    grid=both,
    xlabel={频率 $\omega$ (rad/s)},
    xmin=0.1, xmax=1000
]
\nextgroupplot[ylabel={幅度 (dB)}, legend pos=south west]
\addplot[blue, thick, samples=100, domain=0.1:1000] {20*log10(100/sqrt((100-x^2)^2 + (2*0.1*10*x)^2))};
\addlegendentry{$\zeta=0.1$}
\addplot[red, thick, samples=100, domain=0.1:1000] {20*log10(100/sqrt((100-x^2)^2 + (2*0.5*10*x)^2))};
\addlegendentry{$\zeta=0.5$}
\addplot[green!60!black, thick, samples=100, domain=0.1:1000] {20*log10(100/sqrt((100-x^2)^2 + (2*1.0*10*x)^2))};
\addlegendentry{$\zeta=1.0$}

\nextgroupplot[ylabel={相位 (度)}, legend pos=south west]
\addplot[blue, thick, samples=100, domain=0.1:1000] {deg(-atan2(2*0.1*10*x, 100-x^2))};
\addlegendentry{$\zeta=0.1$}
\addplot[red, thick, samples=100, domain=0.1:1000] {deg(-atan2(2*0.5*10*x, 100-x^2))};
\addlegendentry{$\zeta=0.5$}
\addplot[green!60!black, thick, samples=100, domain=0.1:1000] {deg(-atan2(2*1.0*10*x, 100-x^2))};
\addlegendentry{$\zeta=1.0$}
\end{groupplot}
\end{tikzpicture}
\end{center}

图中所有曲线对应 $\omega_n = 10$ rad/s，不同阻尼比 $\zeta$。

\subsection{伯德图的基本概念}

伯德图由两个图组成，横坐标都是对数刻度的频率 $\omega$：
\begin{itemize}
    \item \textbf{对数幅频图}：纵坐标是系统幅值的对数 $L(\omega) = 20\log_{10}A(\omega)$，单位为分贝(dB)
    \item \textbf{对数相频图}：纵坐标是系统相角 $\phi(\omega)$，单位为度(°)
\end{itemize}

\subsubsection{对数幅频图的转折频率}

\begin{center}
\begin{tabular}{|c|c|c|}
\hline
\textbf{典型环节类别} & \textbf{典型环节传递函数} & \textbf{转折频率及斜率变化} \\
\hline
\multirow{2}{*}{一阶环节} & $\displaystyle\frac{1}{Ts+1}$ & $\omega_c = \frac{1}{T}$，斜率 $-20$ dB/dec \\
\cline{2-3}
& $Ts+1$ & $\omega_c = \frac{1}{T}$，斜率 $+20$ dB/dec \\
\hline
\multirow{2}{*}{二阶环节} & $\displaystyle\frac{1}{(s/\omega_n)^2+2\zeta(s/\omega_n)+1}$ & $\omega_c = \omega_n$，斜率 $-40$ dB/dec \\
\cline{2-3}
& $(s/\omega_n)^2+2\zeta(s/\omega_n)+1$ & $\omega_c = \omega_n$，斜率 $+40$ dB/dec \\
\hline
\end{tabular}
\end{center}

\subsubsection{低频段渐近线的确定}

对于标准型 $G(s) = K \frac{\prod(1+T_i s)}{\prod(1+T_j s)}$（以及其高阶形式）：
\begin{itemize}
    \item 低频段的斜率由系统型别 $v$（积分环节 $s^v$ 的个数）决定，为 $-20v$ dB/dec
    \item 这条渐近线（或其延长线）必定经过点 $(1, 20\log_{10}K)$
    \item 也可以通过点 $(\omega_0, 20\lg K - 20v\lg\omega_0)$ 来确定直线
\end{itemize}

\subsubsection{例题：伯德图绘制示例}

\textbf{例1：绘制 $G(s) = \frac{2}{(2s+1)(8s+1)}$ 的开环对数幅频特性曲线。}

\textit{解：}
\begin{enumerate}
    \item \textbf{标准型}：$G(s) = \frac{2}{(2s+1)(8s+1)}$。开环增益 $K=2$，系统为0型 ($v=0$)
    
    \item \textbf{转折频率}：
    \begin{align*}
    T_1=2 &\implies \omega_1=\frac{1}{2}=0.5 \text{ rad/s} \\
    T_2=8 &\implies \omega_2=\frac{1}{8}=0.125 \text{ rad/s}
    \end{align*}
    按从小到大排列：$\omega_1 = 0.125$ rad/s，$\omega_2 = 0.5$ rad/s
    
    \item \textbf{低频段} ($\omega < 0.125$)：
    \begin{itemize}
        \item 斜率为 $-20 \times 0 = 0$ dB/dec（水平线）
        \item 幅值为 $L(\omega) = 20\lg(2) \approx 6$ dB
    \end{itemize}
    
    \item \textbf{中频段1} ($0.125 < \omega < 0.5$)：
    \begin{itemize}
        \item 经过第一个转折频率 $\omega_1 = 0.125$（一阶极点）
        \item 斜率变为 $0 - 20 = -20$ dB/dec
    \end{itemize}
    
    \item \textbf{高频段} ($\omega > 0.5$)：
    \begin{itemize}
        \item 经过第二个转折频率 $\omega_2 = 0.5$（一阶极点）
        \item 斜率变为 $-20 - 20 = -40$ dB/dec
    \end{itemize}
\end{enumerate}

\subsection{伯德图的绘制方法}

\subsubsection{伯德图绘制六步法}

这是一套标准化、模板化的绘制流程，特别适合考试手绘：

\textbf{第一步：化为"尾1"标准型}

将传递函数中所有的一阶和二阶环节都化为 $(Ts+1)$ 或 $((s/\omega_n)^2 + 2\zeta(s/\omega_n) + 1)$ 的形式。这样可以方便地读出开环增益 $K$ 和各转折频率。

标准形式为：
\begin{align*}
G(s) = K \frac{\prod(1+T_{zi}s)\prod((s/\omega_{ni})^2+2\zeta_i(s/\omega_{ni})+1)}{s^v\prod(1+T_{pi}s)\prod((s/\omega_{nj})^2+2\zeta_j(s/\omega_{nj})+1)}
\end{align*}

\textbf{第二步：列出系统的转折频率}

转折频率（交接频率）是渐近线斜率发生改变的点：
\begin{itemize}
    \item 一阶环节 $(Ts \pm 1)$：转折频率为 $\omega_c = \frac{1}{T}$
    \item 二阶环节 $((s/\omega_n)^2 + ...)$：转折频率为 $\omega_c = \omega_n$
\end{itemize}

\textbf{将所有转折频率从小到大排列}。

\textbf{第三步：确定开环增益 $K$}

从"尾1"标准型中直接读出比例项 $K$。

\textbf{第四步：求与横轴的交点（剪切频率 $\omega_{gc}$）}

横轴（0dB 线）代表 $|G(j\omega)| = 1$。需要求解方程 $|G(j\omega_{gc})| = 1$，利用下面的"幅值近似原则"。

\textbf{第五步：绘制低频段渐近线}

低频段渐近线由以下三个性质唯一确定：
\begin{enumerate}
    \item \textbf{斜率}：由系统型别 $v$（积分环节 $s^v$ 的个数）决定，斜率为 $-20v$ dB/dec
    \item \textbf{定位点1}：低频段渐近线（或其延长线）\textbf{必过点 $(\omega=1, 20\log_{10}K)$}
    \item \textbf{定位点2（$v \geq 1$ 时）}：低频段渐近线（或其延长线）\textbf{与0dB横轴相交于点 $(\omega = \sqrt[v]{K}, 0\text{ dB})$}
\end{enumerate}

\textbf{第六步：依次绘制后续曲线}

从最低的转折频率开始，每经过一个转折频率，渐近线的斜率发生一次改变：

\begin{center}
\begin{tabular}{|c|c|c|}
\hline
\textbf{典型环节} & \textbf{位置} & \textbf{斜率变化} \\
\hline
\multirow{2}{*}{一阶环节} & 分母 & $-20$ dB/dec \\
\cline{2-3}
& 分子 & $+20$ dB/dec \\
\hline
\multirow{2}{*}{二阶环节} & 分母 & $-40$ dB/dec \\
\cline{2-3}
& 分子 & $+40$ dB/dec \\
\hline
\end{tabular}
\end{center}

\textbf{【最终验证】}：绘制完成后，检查最后一个频段的斜率是否等于 $-20(n-m)$ dB/dec，其中 $n$ 是分母阶次，$m$ 是分子阶次。

\subsubsection{幅值近似原则（关键技巧）}

在手绘伯德图和计算剪切频率时，使用的是近似幅值而非精确值。这是加快计算的关键：

\textbf{一阶环节 $(Ts+1)$ 的近似}：
\begin{itemize}
    \item 在转折频率前（$\omega < 1/T$）：虚部 $T\omega < 1$，\textbf{保留常数项1}。环节幅值近似为 $1$
    \item 在转折频率后（$\omega > 1/T$）：虚部 $T\omega > 1$，\textbf{保留虚部项 $T\omega$}。环节幅值近似为 $T\omega$
\end{itemize}

\textbf{二阶环节 $((s/\omega_n)^2 + ...)$ 的近似}：
\begin{itemize}
    \item 在转折频率前（$\omega < \omega_n$）：\textbf{保留常数项1}。环节幅值近似为 $1$
    \item 在转折频率后（$\omega > \omega_n$）：\textbf{保留平方项 $(s/\omega_n)^2$}。环节幅值近似为 $(\omega/\omega_n)^2$
\end{itemize}

\subsubsection{基本步骤（原有内容）}
\begin{enumerate}
    \item \textbf{将传递函数化为标准形式}
    \begin{align*}
    G(s) = \frac{K\prod(1+T_i s)\prod(\frac{s^2}{\omega_{ni}^2}+\frac{2\zeta_i}{\omega_{ni}}s+1)}{s^v\prod(1+T_j s)\prod(\frac{s^2}{\omega_{nj}^2}+\frac{2\zeta_j}{\omega_{nj}}s+1)}
    \end{align*}
    
    \item \textbf{识别各个典型环节}
    \begin{itemize}
        \item 比例环节 $K$
        \item 积分/微分环节 $s^{\pm v}$
        \item 一阶环节 $(1+Ts)^{\pm 1}$
        \item 二阶环节 $(\frac{s^2}{\omega_n^2}+\frac{2\zeta s}{\omega_n}+1)^{\pm 1}$
    \end{itemize}
    
    \item \textbf{确定转折频率}
    \begin{itemize}
        \item 一阶环节：$\omega_c = \frac{1}{T}$
        \item 二阶环节：$\omega_c = \omega_n$
        \item 按从小到大排列所有转折频率
    \end{itemize}
    
    \item \textbf{绘制低频渐近线}
    \begin{itemize}
        \item 起始点：选择 $\omega = 1$ rad/s 或最小转折频率的 $\frac{1}{10}$
        \item 起始斜率：由积分环节数 $v$ 决定（$-20v$ dB/十倍频）
        \item 起始幅值：$L(\omega_0) = 20\lg K - 20v\lg\omega_0$
    \end{itemize}
    
    \item \textbf{绘制各段渐近线}
    \begin{itemize}
        \item 每经过一个转折频率，斜率改变
        \item 零点（分子）：斜率增加
        \begin{itemize}
            \item 一阶零点：$+20$ dB/十倍频
            \item 二阶零点：$+40$ dB/十倍频
        \end{itemize}
        \item 极点（分母）：斜率减少
        \begin{itemize}
            \item 一阶极点：$-20$ dB/十倍频
            \item 二阶极点：$-40$ dB/十倍频
        \end{itemize}
    \end{itemize}
    
    \item \textbf{修正转折频率附近的误差}
    \begin{itemize}
        \item 一阶环节在 $\omega = \omega_c$ 处：$-3$ dB（极点）或 $+3$ dB（零点）
        \item 二阶环节：根据阻尼比 $\zeta$ 修正
    \end{itemize}
    
    \item \textbf{绘制相频特性}
    \begin{itemize}
        \item 每个环节的相位直接相加
        \item 注意各环节的相位贡献
    \end{itemize}
\end{enumerate}

\subsubsection{转折频率处的修正}

\textbf{一阶环节 $\frac{1}{1+Ts}$ 的修正：}

\begin{center}
\begin{tabular}{c|c|c}
\hline
频率 & 渐近线误差 & 精确值修正 \\
\hline
$0.5\omega_c$ & $0$ dB & $-1$ dB \\
$\omega_c$ & $0$ dB & $-3$ dB \\
$2\omega_c$ & $0$ dB & $-1$ dB \\
\hline
\end{tabular}
\end{center}

\textbf{二阶环节的修正}

取决于阻尼比 $\zeta$，在 $\omega = \omega_n$ 处：
\begin{itemize}
    \item $\zeta = 0.1$：谐振峰值约 $+14$ dB
    \item $\zeta = 0.2$：谐振峰值约 $+7$ dB
    \item $\zeta = 0.3$：谐振峰值约 $+3$ dB
    \item $\zeta = 0.5$：误差约 $-1$ dB
    \item $\zeta = 0.707$：误差 $-3$ dB（临界阻尼）
    \item $\zeta = 1.0$：误差 $-6$ dB（过阻尼）
\end{itemize}

\subsubsection{六步法综合例题}

\textbf{例1：绘制 $G(s) = \frac{8(\frac{s}{0.1}+1)}{s(s^2+s+1)(\frac{s}{2}+1)}$ 的开环对数幅频特性曲线。}

\textit{解：}
\begin{enumerate}
    \item \textbf{化为标准型}：
    \[G(s) = \frac{8(10s+1)}{s(s^2+s+1)(0.5s+1)}\]
    
    \item \textbf{转折频率}：
    \begin{itemize}
        \item 分子一阶：$T_z=10 \implies \omega_1 = \frac{1}{10} = 0.1$ rad/s（零点，+20 dB/dec）
        \item 分母二阶：由 $s^2+s+1 = 0$ 得 $2\zeta\omega_n = 1, \omega_n^2 = 1$，所以 $\omega_n=1$ rad/s（极点，-40 dB/dec）
        \item 分母一阶：$T_p=0.5 \implies \omega_3 = \frac{1}{0.5} = 2$ rad/s（极点，-20 dB/dec）
        \item 排序：$0.1, 1, 2$
    \end{itemize}
    
    \item \textbf{开环增益}：$K = 8$
    
    \item \textbf{低频段} ($\omega < 0.1$)：
    \begin{itemize}
        \item 系统为I型 ($v=1$)，斜率为 $-20$ dB/dec
        \item 与0dB轴交于 $\omega = \sqrt[1]{K} = 8$ rad/s
        \item 但 $8 > 0.1$，说明交点不在低频段
        \item 可用定位点：在 $\omega=1$ 处，幅值为 $L(1) = 20\lg 8 - 20 \times 1 = 18.06$ dB
    \end{itemize}
    
    \item \textbf{各频段渐近线}：
    \begin{itemize}
        \item $0.1 < \omega < 1$：经过 $\omega_1=0.1$（分子一阶零点），斜率变为 $-20+20=0$ dB/dec
        \item $1 < \omega < 2$：经过 $\omega_2=1$（分母二阶极点），斜率变为 $0-40=-40$ dB/dec
        \item $\omega > 2$：经过 $\omega_3=2$（分母一阶极点），斜率变为 $-40-20=-60$ dB/dec
    \end{itemize}
    
    \item \textbf{最终验证}：
    \begin{itemize}
        \item 分子阶次 $m=1$（一阶零点）
        \item 分母阶次 $n=4$（1个一阶 + 1个二阶 + 1个积分 = 4）
        \item 最终斜率应为 $-20(n-m) = -20(4-1) = -60$ dB/dec，正确✓
    \end{itemize}
\end{enumerate}

\subsubsection{剪切频率的计算}

剪切频率（增益穿越频率 $\omega_{gc}$）是幅值等于1（0 dB）的频率，通过求解 $|G(j\omega_{gc})| = 1$ 得到。

\textbf{计算方法}：利用幅值近似原则
\begin{enumerate}
    \item 在不同频段，根据主导环节使用近似幅值
    \item 在所有转折频率处分别计算幅值，判断穿越点在哪一段
    \item 在该频段内使用简化的近似幅值公式求解
\end{enumerate}

\textbf{典型例子}：$G(s) = \frac{2}{(2s+1)(8s+1)}$

设 $\omega_1 = 0.125, \omega_2 = 0.5$，则：
\begin{itemize}
    \item 低频 $\omega < 0.125$：$|G(j\omega)| \approx 2$（>1），不包含穿越点
    \item 中频 $0.125 < \omega < 0.5$：$|G(j\omega)| \approx \frac{2}{8\omega}$
    \begin{itemize}
        \item 令 $\frac{2}{8\omega} = 1 \implies \omega = 0.25$
        \item 由于 $0.125 < 0.25 < 0.5$，假设成立，所以 $\omega_{gc} = 0.25$
    \end{itemize}
    \item 高频验证：若需更精确，可用精确公式验证
\end{itemize}

\subsubsection{绘图示例}

\textbf{例1：}绘制 $G(s) = \frac{10}{s(1+0.1s)}$ 的伯德图

\begin{tcolorbox}[colback=blue!5!white,colframe=blue!75!black,title=例1求解过程与伯德图]

\begin{minipage}[t]{0.47\textwidth}
\textbf{解：}
\begin{enumerate}
    \item 标准形式：$G(s) = \frac{10}{s(1+0.1s)}$，$K = 10$
    \item 环节识别：
    \begin{itemize}
        \item 积分环节：$\frac{1}{s}$（$v=1$）
        \item 惯性环节：$\frac{1}{1+0.1s}$，$T=0.1$
    \end{itemize}
    \item 转折频率：$\omega_c = \frac{1}{T} = 10$ rad/s
    \item 幅频特性：
    \begin{itemize}
        \item 起点：$L(1) = 20$ dB
        \item $\omega < 10$：$-20$ dB/十倍频
        \item $\omega > 10$：$-40$ dB/十倍频
        \item 修正：$-3$ dB @ $\omega=10$
    \end{itemize}
    \item 相频特性：
    \begin{itemize}
        \item $\phi(\omega) = -90° - \arctan(0.1\omega)$
        \item @ $\omega = 10$：$\phi = -135°$
    \end{itemize}
\end{enumerate}
\end{minipage}\hfill
\begin{minipage}[t]{0.47\textwidth}
% G(s) = 10/(s(1+0.1s)) -> num=10, den=0.1 s^2 + 1 s + 0
\BodeTF{num/{10},den/{0.1,1,0}}{0.1}{1000}
\end{minipage}

\end{tcolorbox}

\textbf{例2：}绘制 $G(s) = \frac{100(s+1)}{s(s+10)}$ 的伯德图

\begin{tcolorbox}[colback=blue!5!white,colframe=blue!75!black,title=例2求解过程与伯德图]

\begin{minipage}[t]{0.47\textwidth}
\textbf{解：}
\begin{enumerate}
    \item 标准形式：$G(s) = \frac{10(1+s)}{s(1+0.1s)}$，$K = 10$
    \item 环节识别：
    \begin{itemize}
        \item 积分环节：$\frac{1}{s}$
        \item 一阶零点：$(1+s)$
        \item $\omega_{c1} = 1$ rad/s
        \item 一阶极点：$\frac{1}{1+0.1s}$
        \item $\omega_{c2} = 10$ rad/s
    \end{itemize}
    \item 转折频率：$1$ rad/s（零点），$10$ rad/s（极点）
    \item 幅频特性：
    \begin{itemize}
        \item 低频 $\omega<1$：$-20$ dB/十倍频
        \item 中频 $1<\omega<10$：$0$ dB/十倍频
        \item 高频 $\omega>10$：$-20$ dB/十倍频
    \end{itemize}
    \item 相频特性：
    \begin{itemize}
        \item $\phi(\omega) = -90° + \arctan(\omega)$ 
        \item $\quad - \arctan(0.1\omega)$
    \end{itemize}
\end{enumerate}
\end{minipage}\hfill
\begin{minipage}[t]{0.47\textwidth}
% G(s) = 100(s+1)/(s(s+10)) -> num=100 s + 100, den = s^2 + 10 s + 0
\BodeTF{num/{100,100},den/{1,10,0}}{0.1}{1000}
\end{minipage}

\end{tcolorbox}

\textbf{例3：}二阶系统 $G(s) = \frac{100}{s^2 + 2s + 100}$

\begin{tcolorbox}[colback=blue!5!white,colframe=blue!75!black,title=例3求解过程与伯德图]

\begin{minipage}[t]{0.47\textwidth}
\textbf{解：}
\begin{enumerate}
    \item 标准形式：
    $$G(s) = \frac{\omega_n^2}{s^2 + 2\zeta\omega_n s + \omega_n^2}$$
    
    \item 参数识别：
    \begin{itemize}
        \item $\omega_n = 10$ rad/s
        \item $\zeta = 0.1$
        \item 极点：$-1 \pm 9.95j$
    \end{itemize}
    
    \item 特性分析：
    \begin{itemize}
        \item 转折频率：$10$ rad/s
        \item $\zeta < 0.707$，有谐振
        \item 谐振频率：$\approx 9.9$ rad/s
        \item 谐振峰值：$\approx 5.03$（14 dB）
    \end{itemize}
\end{enumerate}
\end{minipage}\hfill
\begin{minipage}[t]{0.47\textwidth}
\BodeTF{num/{100},den/{1,2,100}}{0.1}{1000}
\end{minipage}

\end{tcolorbox}

\subsection{伯德图的应用}

\subsubsection{由伯德图确定传递函数}
根据伯德图的幅频特性，可以反推传递函数：
\begin{enumerate}
    \item 从低频渐近线斜率确定积分环节数 $v$
    \item 从转折频率确定各环节的时间常数
    \item 从低频幅值确定增益 $K$
    \item 从斜率变化确定零极点类型
\end{enumerate}

\subsubsection{稳定性分析}
\textbf{增益裕度（Gain Margin，GM）：}
\begin{align*}
\text{GM} = -L(\omega_g) \text{ dB}
\end{align*}
其中 $\omega_g$ 为相位穿越频率（$\phi(\omega_g) = -180°$）

\textbf{相位裕度（Phase Margin，PM）：}
\begin{align*}
\text{PM} = 180° + \phi(\omega_c)
\end{align*}
其中 $\omega_c$ 为幅值穿越频率（$L(\omega_c) = 0$ dB）

\textbf{稳定性判据：}
\begin{itemize}
    \item 稳定条件：GM $> 0$ dB 且 PM $> 0°$
    \item 一般要求：GM $\geq 6$ dB，PM $\geq 30°$
    \item 良好性能：GM $\geq 10$ dB，PM $\geq 45°$
\end{itemize}

\subsubsection{性能指标估算}
\begin{itemize}
    \item \textbf{带宽频率} $\omega_b$：$L(\omega_b) = -3$ dB 对应的频率
    \begin{itemize}
        \item 带宽越大，系统响应越快
    \end{itemize}
    \item \textbf{谐振峰值} $M_r$：幅频特性的最大值
    \begin{itemize}
        \item $M_r$ 越大，超调量越大
        \item 一般要求 $M_r < 1.3$（即 $< 2.3$ dB）
    \end{itemize}
    \item \textbf{低频增益}：反映稳态精度
    \begin{itemize}
        \item 型别越高，低频增益越大，稳态误差越小
    \end{itemize}
    \item \textbf{中频段斜率}：影响稳定性
    \begin{itemize}
        \item 斜率为 $-20$ dB/十倍频时系统一般稳定
        \item 斜率为 $-40$ dB/十倍频时需检查相位裕度
    \end{itemize}
\end{itemize}
