\section{根轨迹基本概念及其绘制（180°）}

\subsection{根轨迹的定义}
当系统中某一参数从零变化到无穷大时，闭环系统特征方程的根在 $s$ 平面上的运动轨迹称为根轨迹。

\subsection{根轨迹方程}
闭环特征方程：$1 + KG(s)H(s) = 0$

根轨迹方程的两个条件：
\begin{itemize}
    \item \textbf{幅值条件}：$|G(s)H(s)| = \frac{1}{K}$
    \item \textbf{相角条件}：$\angle G(s)H(s) = \pm 180°(2k+1)$，$k = 0, 1, 2, \cdots$
\end{itemize}

\subsection{绘制根轨迹的基本法则}
\begin{enumerate}
    \item 根轨迹的分支数等于开环极点数 $n$ 和开环零点数 $m$ 中的较大者
    \item 根轨迹起始于开环极点，终止于开环零点（有限零点或无限远零点）
    \item 根轨迹关于实轴对称
    \item 实轴上的根轨迹：实轴上某点右侧开环实零点和实极点总数为奇数
    \item 根轨迹的渐近线：
    \begin{align}
    \sigma_a &= \frac{\sum_{i=1}^n p_i - \sum_{j=1}^m z_j}{n-m} \\
    \phi_a &= \frac{(2k+1)180°}{n-m}, \quad k = 0, 1, \cdots, n-m-1
    \end{align}
    \item 分离点的计算：$\frac{d}{ds}[G(s)H(s)] = 0$
    \item 与虚轴的交点：利用劳斯判据
\end{enumerate}

\subsection{使用 pgfplots 绘制根轨迹}

使用 pgfplots 包可以方便地绘制根轨迹。以下是一个典型示例：

\subsubsection{例1：二阶系统的根轨迹}

\begin{center}
\begin{tikzpicture}
\begin{axis}[
    width=10cm, height=8cm,
    xlabel={实部 $\sigma$},
    ylabel={虚部 $j\omega$},
    grid=both,
    unit vector ratio=1 1 1,
    title={根轨迹图：$G(s)H(s) = \frac{K}{(s+1)(s+3)}$},
    xmin=-4, xmax=1,
    ymin=-3.5, ymax=3.5,
    axis lines=middle,
    legend pos=north east
]

% 开环极点
\addplot[red, mark=x, mark size=8pt, mark options={thick}, only marks] 
    coordinates {(-1,0) (-3,0)};

% 根轨迹 - 实轴上的部分（$-3$ 到 $-1$）
\addplot[blue, thick, domain=-3:-1, samples=50] {0};
\addlegendentry{根轨迹}

% 根轨迹 - 复平面部分（圆形）
\addplot[blue, thick, domain=-180:180, samples=150] 
    ({-2 + cos(x)}, {sin(x)});

% 渐近线
\addplot[dashed, gray, thick] coordinates {(-2,-3.5) (-2,3.5)};
\addlegendentry{渐近线}

% 标注极点
\node[red, font=\small] at (axis cs:-1,-0.5) {$p_1=-1$};
\node[red, font=\small] at (axis cs:-3,-0.5) {$p_2=-3$};

% 标注渐近线
\node[gray, font=\small] at (axis cs:-2,3.2) {$\sigma_a=-2$};

% 标注关键点
\node[blue, font=\tiny] at (axis cs:-0.5,0.2) {$K=0$};
\node[blue, font=\tiny] at (axis cs:-2,1.2) {$K=1$};

\end{axis}
\end{tikzpicture}
\end{center}

\textbf{参数说明}：
\begin{itemize}
    \item 开环传递函数：$G(s)H(s) = \frac{K}{(s+1)(s+3)}$
    \item 极点：$p_1 = -1$，$p_2 = -3$
    \item 渐近线中心：$\sigma_a = \frac{-1+(-3)}{2} = -2$
    \item 根轨迹类型：实轴 + 圆形轨迹
\end{itemize}

\subsubsection{例2：三阶系统的根轨迹}

\begin{center}
\begin{tikzpicture}
\begin{axis}[
    width=10cm, height=8cm,
    xlabel={实部 $\sigma$},
    ylabel={虚部 $j\omega$},
    grid=both,
    unit vector ratio=1 1 1,
    title={根轨迹图：$G(s)H(s) = \frac{K}{s(s+1)(s+3)}$},
    xmin=-4, xmax=0.5,
    ymin=-4, ymax=4,
    axis lines=middle,
    legend pos=north east
]

% 开环极点
\addplot[red, mark=x, mark size=8pt, mark options={thick}, only marks] 
    coordinates {(0,0) (-1,0) (-3,0)};

% 实轴部分：(-3, -1) 和 (-∞, 0)
\addplot[blue, thick, domain=-3:-1, samples=50] {0};
\addplot[blue, thick, domain=-4:0, samples=50] {0};
\addlegendentry{根轨迹}

% 渐近线：$\sigma_a = \frac{0-1-3}{3-0} = -\frac{4}{3}$
% 角度：$\phi_a = \frac{(2k+1) \times 180°}{3}$，$k=0,1,2$
% $\phi_a = 60°, 180°, 300°$

\addplot[dashed, gray, thick, domain=-4:2, samples=50] 
    {(tan(60)) * (x + 4/3)};
\addplot[dashed, gray, thick, domain=-4:2, samples=50] 
    {-(tan(60)) * (x + 4/3)};
\addplot[dashed, gray, thick, domain=-4:1, samples=50] {0 * x};
\addlegendentry{渐近线}

% 标注极点
\node[red, font=\small] at (axis cs:0,-0.6) {$p_3=0$};
\node[red, font=\small] at (axis cs:-1,-0.6) {$p_1=-1$};
\node[red, font=\small] at (axis cs:-3,-0.6) {$p_2=-3$};

% 标注渐近线中心
\node[gray, font=\small] at (axis cs:-4/3,3.5) {$\sigma_a=-\frac{4}{3}$};

\end{axis}
\end{tikzpicture}
\end{center}

\textbf{参数说明}：
\begin{itemize}
    \item 开环传递函数：$G(s)H(s) = \frac{K}{s(s+1)(s+3)}$
    \item 极点数 $n=3$，零点数 $m=0$
    \item 渐近线中心：$\sigma_a = \frac{0-1-3}{3-0} = -\frac{4}{3}$
    \item 渐近线角度：$\phi_a = \frac{(2k+1) \times 180°}{3}$，$k=0,1,2$
    \begin{align*}
    \phi_a &= 60°, 180°, 300°
    \end{align*}
\end{itemize}

\subsection{绘制根轨迹的步骤总结}

\begin{enumerate}
    \item \textbf{确定开环极点和零点}：在复平面上标记（极点用 × 表示，零点用 ○ 表示）
    
    \item \textbf{绘制实轴部分}：满足 \texttt{相角条件} 的实轴线段
    \begin{itemize}
        \item 实轴上某点右侧的开环零点和极点总数为奇数时，该点在根轨迹上
    \end{itemize}
    
    \item \textbf{绘制渐近线}：
    \begin{align*}
    \sigma_a &= \frac{\sum p_i - \sum z_j}{n-m} \\
    \phi_a &= \frac{(2k+1) \times 180°}{n-m}, \quad k=0,1,\cdots,n-m-1
    \end{align*}
    
    \item \textbf{计算分离点和汇合点}：解方程 $\frac{d}{ds}[G(s)H(s)] = 0$
    
    \item \textbf{确定与虚轴的交点}：使用劳斯判据或代入 $s=j\omega$
    
    \item \textbf{绘制完整轨迹}：连接各部分形成光滑曲线
\end{enumerate}
